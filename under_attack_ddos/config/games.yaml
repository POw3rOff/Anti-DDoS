# Distributed Game Defense Configuration
# Defines protection profiles for specific game protocols.

games:
  metin2:
    protocols:
      - name: "login_tcp"
        port_range: "11000-11005"
        transport: "TCP"
        location: "CORE" # Mitigation happens at the game server
        checks: ["connection_rate", "payload_size"]
      - name: "world_tcp"
        port_range: "13000-13099"
        transport: "TCP"
        location: "CORE"

  rust:
    protocols:
      - name: "raknet_udp"
        port_range: "28015"
        transport: "UDP"
        location: "EDGE" # Mitigation can happen at Edge (RakNet is connectionless-ish)
        checks: ["packet_rate", "payload_regex"]
        regex: "^\\xff\\xff\\xff\\xff" # Source/Raknet query header

  fivem:
    protocols:
      - name: "citadel_udp"
        port_range: "30120"
        transport: "UDP"
        location: "EDGE"
        checks: ["amplification_check", "token_validation"]
      - name: "http_announce"
        port_range: "30120"
        transport: "TCP"
        location: "EDGE"

  csgo:
    protocols:
      - name: "source_query"
        port_range: "27015"
        transport: "UDP"
        location: "EDGE"
        checks: ["a2s_info_flood", "reflection_check"]

distributed:
  # Policies for syncing between Edge (LB) and Core (Game Host)
  sync_enabled: true
  sync_interval_seconds: 2

  roles:
    edge:
      actions: ["drop_packet", "rate_limit_ip", "blackhole_route"]
      threshold_multiplier: 1.0
    core:
      actions: ["close_socket", "iptables_local", "signal_edge"]
      threshold_multiplier: 0.8 # Core is more sensitive

  communication:
    method: "redis_pubsub" # or "http_webhook"
    redis_host: "10.0.0.1"
    redis_port: 6379
    channel: "ddos_sync"
